# restart
SELECT @@rocksdb_select_bypass_policy;
@@rocksdb_select_bypass_policy
always_off
SELECT @@rocksdb_select_bypass_policy into @save_rocksdb_select_bypass_policy;
set global rocksdb_select_bypass_policy=2;
SELECT @@rocksdb_select_bypass_policy;
@@rocksdb_select_bypass_policy
opt_in
SELECT @@rocksdb_select_bypass_allow_filters;
@@rocksdb_select_bypass_allow_filters
1
SELECT @@rocksdb_select_bypass_allow_filters into
@save_rocksdb_select_bypass_allow_filters;
set global rocksdb_select_bypass_allow_filters=0;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
0
SELECT @@rocksdb_select_bypass_fail_unsupported;
@@rocksdb_select_bypass_fail_unsupported
1
SELECT @@rocksdb_select_bypass_fail_unsupported into @save_fail_unsupported;
Test bypass failing with unsupported scenario
set global rocksdb_select_bypass_fail_unsupported=true;
SELECT @@rocksdb_select_bypass_fail_unsupported;
@@rocksdb_select_bypass_fail_unsupported
1
SELECT /*+ bypass */ pk from t1 WHERE pk=1 having pk=1;
ERROR 42000: SELECT statement pattern not supported: HAVING not supported
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	1
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
set global rocksdb_select_bypass_rejected_query_history_size=3;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
3
SELECT /*+ bypass */ pk from t1 WHERE pk=1 group by pk;
ERROR 42000: SELECT statement pattern not supported: GROUP BY not supported
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	2
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = ? GROUP BY `pk`	GROUP BY not supported	SQL
SELECT /*+ bypass */ * from t1 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: Unrecognized field name: '*'
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	3
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT * FROM `t1` WHERE `pk` = ?	Unrecognized field name: '*'	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? GROUP BY `pk`	GROUP BY not supported	SQL
SELECT /*+ bypass */ 1 from t1 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: SELECT expressions can only be field
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	4
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT * FROM `t1` WHERE `pk` = ?	Unrecognized field name: '*'	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? GROUP BY `pk`	GROUP BY not supported	SQL
SELECT /*+ bypass */ 1+2 from t1 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: SELECT expressions can only be field
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	5
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ? + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT * FROM `t1` WHERE `pk` = ?	Unrecognized field name: '*'	SQL
SELECT /*+ bypass */ COUNT(*) from t1 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: SELECT expressions can only be field
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	6
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT COUNT ( * ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ COUNT(pk) from t1 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: SELECT expressions can only be field
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	7
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT COUNT ( `pk` ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( * ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk+1 from t1 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: SELECT expressions can only be field
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	8
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( `pk` ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( * ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk from t1 USE INDEX (PRIMARY) WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: Index hint must be FORCE INDEX
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	9
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` USE INDEX ( PRIMARY ) WHERE `pk` = ?	Index hint must be FORCE INDEX	SQL
SELECT `pk` + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( `pk` ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk from t1;
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	10
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` USE INDEX ( PRIMARY ) WHERE `pk` = ?	Index hint must be FORCE INDEX	SQL
SELECT `pk` + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=1 or pk=2;
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	11
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = ? OR `pk` = ?	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` USE INDEX ( PRIMARY ) WHERE `pk` = ?	Index hint must be FORCE INDEX	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2 AND pk > 3;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	0
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	12
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? OR `pk` = ?	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND a = 1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	1
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	12
SELECT /*+ bypass */ pk from t1 WHERE pk = 1 AND a = 1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	2
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	12
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b = 2 AND c = 3 AND d > 4;
d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	3
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	12
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b = 2 AND c > 3 AND d > 4;
d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	12
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b = 2 AND d > 4;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	13
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b > 2 AND d > 4;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	14
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	15
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `d` FROM `t1` FORCE INDEX ( `a` ) WHERE `a` = ? AND `b` > ? AND `d` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `d` FROM `t1` FORCE INDEX ( `a` ) WHERE `a` = ? AND `b` = ? AND `d` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk < 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	16
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `d` FROM `t1` FORCE INDEX ( `a` ) WHERE `a` = ? AND `b` > ? AND `d` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk <= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	17
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk >= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	18
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk >= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	19
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk > 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	20
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2 AND pk > 3;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk >= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk >= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk > 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk >= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk < 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk <= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk <= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk < 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b in (1, 2);
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0 and c > 0;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk <= 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	34
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk < 2;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	35
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b in (1, 2);
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0 and c > 0;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	38
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk<=>1;
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE - needs to be >, >=, <, <=, =, IN
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	39
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=(1,2,3);
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE - operand should be int/string/real/varbinary
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	4
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	40
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
set global rocksdb_select_bypass_rejected_query_history_size=4;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
4
SELECT /*+ bypass */ pk from t1 WHERE pk=DATE '2019-03-25';
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	5
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	40
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=TIME '18:01:00';
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	6
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	40
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=TIMESTAMP '2019-03-25 18:01:00';
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	40
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=ANY (SELECT pk FROM t1);
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	41
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk>ALL (SELECT pk FROM t1);
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE - needs to be >, >=, <, <=, =, IN
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	42
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ALL ( SELECT `pk` FROM `t1` )	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ DISTINCT a from t1;
ERROR 42000: SELECT statement pattern not supported: SELECT options not supported (such as SELECT DISTINCT)
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	43
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT DISTINCTROW `a` FROM `t1`	SELECT options not supported (such as SELECT DISTINCT)	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ALL ( SELECT `pk` FROM `t1` )	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = (...)	Unsupported WHERE - operand should be int/string/real/varbinary	SQL
SELECT /*+ bypass */ ALL a, b from t1;
ERROR 42000: SELECT statement pattern not supported: Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	44
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT DISTINCTROW `a` FROM `t1`	SELECT options not supported (such as SELECT DISTINCT)	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ALL ( SELECT `pk` FROM `t1` )	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
set global rocksdb_select_bypass_rejected_query_history_size=1;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
1
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ t1.pk, t2.pk from t1, t2;
pk	pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	44
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ t1.pk FROM t1 LEFT JOIN t2 using (pk)
WHERE t1.pk=1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	44
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ pk, a from (SELECT pk, a FROM t1) AS t1_temp;
pk	a
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	44
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ pk FROM t1 WHERE pk=3 UNION DISTINCT
SELECT pk FROM t2 WHERE pk=3;
pk
SELECT /*+ bypass */ pk FROM t1 WHERE pk=3 UNION ALL
SELECT pk FROM t2 WHERE pk=3;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	44
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ a, b, c FROM t1 WHERE a=1 ORDER BY a;
ERROR 42000: SELECT statement pattern not supported: ORDER BY field doesn't belong to the index
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY b, a;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1
ORDER BY a, b, c, c, c, a, b, c, d;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY c, a;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY a, a;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1
ORDER BY a, a, a, a, a, a, a, a;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY b, b;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SELECT /*+ bypass */ a, b, c FROM t3 FORCE INDEX(`a`) WHERE a=1 ORDER BY b, b;
ERROR 42000: SELECT statement pattern not supported: ORDER BY is not in index order
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	52
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` , `c` FROM `t3` FORCE INDEX ( `a` ) WHERE `a` = ? ORDER BY `b` , `b`	ORDER BY is not in index order	SQL
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`abc`) WHERE a=1 ORDER BY b, a;
ERROR 42000: SELECT statement pattern not supported: Unrecognized index: 'abc'
SELECT /*+ bypass */ a from t1 WHERE a=1 INTO OUTFILE 'datadir/select.out';
ERROR 42000: SELECT statement pattern not supported: SELECT INTO/DUMP not supported
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	54
SELECT /*+ bypass */ a from t1 WHERE a=1 INTO DUMPFILE 'datadir/select.dump';
ERROR 42000: SELECT statement pattern not supported: SELECT INTO/DUMP not supported
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	55
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 FOR UPDATE;
ERROR 42000: SELECT statement pattern not supported: Only SELECT with default READ lock is supported
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 FOR UPDATE SKIP LOCKED;
ERROR 42000: SELECT statement pattern not supported: Only SELECT with default READ lock is supported
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 FOR UPDATE NOWAIT;
ERROR 42000: SELECT statement pattern not supported: Only SELECT with default READ lock is supported
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 LOCK IN SHARE MODE;
ERROR 42000: SELECT statement pattern not supported: Only SELECT with default READ lock is supported
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` , `c` FROM `t3` WHERE `pk` = ? LOCK IN SHARE MODE	Only SELECT with default READ lock is supported	SQL
SELECT /*+ bypass */ HIGH_PRIORITY a, b, c FROM t3 WHERE pk=1;
ERROR 42000: SELECT statement pattern not supported: Only SELECT with default READ lock is supported
SELECT /*+ bypass */ a FROM t3 WHERE a=1 AND a=1 AND a=1 AND a=1 AND a=1 AND
a=1 AND a=1 AND a=1 AND a=1 AND a=1 AND
a=1 AND a=1 AND a=1 AND a=1 AND a=1 AND
a=1 AND a=1;
ERROR 42000: SELECT statement pattern not supported: Too many WHERE expressions
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` FROM `t3` WHERE `a` = ? AND `a` = ? AND `a` = ? AND `a` = ? AND `a` = ? AND `a` = ? AND `	Too many WHERE expressions	SQL
SELECT /*+ bypass */ a FROM t4 WHERE a=1;
ERROR 42000: SELECT statement pattern not supported: NULL fields not supported
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` FROM `t4` WHERE `a` = ?	NULL fields not supported	SQL
SELECT /*+ bypass */ a,b FROM t5 FORCE INDEX (a) WHERE a='abc';
ERROR 42000: SELECT statement pattern not supported: only binary, utf8_bin, latin1_bin is supported for varchar cond field
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` FROM `t5` FORCE INDEX ( `a` ) WHERE `a` = ?	only binary, utf8_bin, latin1_bin is supported for varchar cond field	SQL
set global rocksdb_select_bypass_rejected_query_history_size=1;
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE data = 'data100';
ERROR 42000: SELECT statement pattern not supported: only binary, utf8_bin, latin1_bin is supported for varchar cond field
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE DATA = ?	only binary, utf8_bin, latin1_bin is supported for varchar cond field	SQL
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE id1 > 100 and id1 < 300 and id1 > 110;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE `id1` > 	Unsupported range query pattern	SQL
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE link_type>100 and link_type > 200 and time=305;
ERROR 42000: SELECT statement pattern not supported: Unsupported range query pattern
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE `link_ty	Unsupported range query pattern	SQL
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE link_type=404 and time > 300;
ERROR 42000: SELECT statement pattern not supported: Non-optimal queries with filters are not allowed
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE `link_ty	Non-optimal queries with filters are not allowed	SQL
drop table t1;
drop table t2;
drop table t3;
drop table t4;
drop table t5;
drop table t6;
Test bypass fallback with unsupported scenario
set global rocksdb_select_bypass_fail_unsupported=false;
SELECT @@rocksdb_select_bypass_fail_unsupported;
@@rocksdb_select_bypass_fail_unsupported
0
SELECT /*+ bypass */ pk from t1 WHERE pk=1 having pk=1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	68
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = ? HAVING `pk` = ?	HAVING not supported	SQL
set global rocksdb_select_bypass_rejected_query_history_size=3;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
3
SELECT /*+ bypass */ pk from t1 WHERE pk=1 group by pk;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	69
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = ? GROUP BY `pk`	GROUP BY not supported	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? HAVING `pk` = ?	HAVING not supported	SQL
SELECT /*+ bypass */ * from t1 WHERE pk=1;
pk	a	b	c	d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	70
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT * FROM `t1` WHERE `pk` = ?	Unrecognized field name: '*'	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? GROUP BY `pk`	GROUP BY not supported	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? HAVING `pk` = ?	HAVING not supported	SQL
SELECT /*+ bypass */ 1 from t1 WHERE pk=1;
1
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	71
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT * FROM `t1` WHERE `pk` = ?	Unrecognized field name: '*'	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? GROUP BY `pk`	GROUP BY not supported	SQL
SELECT /*+ bypass */ 1+2 from t1 WHERE pk=1;
1+2
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	72
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ? + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT * FROM `t1` WHERE `pk` = ?	Unrecognized field name: '*'	SQL
SELECT /*+ bypass */ COUNT(*) from t1 WHERE pk=1;
COUNT(*)
0
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	73
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT COUNT ( * ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ COUNT(pk) from t1 WHERE pk=1;
COUNT(pk)
0
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	74
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT COUNT ( `pk` ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( * ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT ? + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk+1 from t1 WHERE pk=1;
pk+1
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	75
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( `pk` ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( * ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk from t1 USE INDEX (PRIMARY) WHERE pk=1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	76
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` USE INDEX ( PRIMARY ) WHERE `pk` = ?	Index hint must be FORCE INDEX	SQL
SELECT `pk` + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT COUNT ( `pk` ) FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk from t1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	77
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` USE INDEX ( PRIMARY ) WHERE `pk` = ?	Index hint must be FORCE INDEX	SQL
SELECT `pk` + ? FROM `t1` WHERE `pk` = ?	SELECT expressions can only be field	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=1 or pk=2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	78
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = ? OR `pk` = ?	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` USE INDEX ( PRIMARY ) WHERE `pk` = ?	Index hint must be FORCE INDEX	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2 AND pk > 3;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	7
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	79
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` = ? OR `pk` = ?	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND a = 1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	8
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	79
SELECT /*+ bypass */ pk from t1 WHERE pk = 1 AND a = 1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	9
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	79
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b = 2 AND c = 3 AND d > 4;
d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	10
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	79
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b = 2 AND c > 3 AND d > 4;
d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	79
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b = 2 AND d > 4;
d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	80
SELECT /*+ bypass */ d from t1 FORCE INDEX (a)
WHERE a = 1 AND b > 2 AND d > 4;
d
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	81
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	82
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `d` FROM `t1` FORCE INDEX ( `a` ) WHERE `a` = ? AND `b` > ? AND `d` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `d` FROM `t1` FORCE INDEX ( `a` ) WHERE `a` = ? AND `b` = ? AND `d` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk < 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	83
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `d` FROM `t1` FORCE INDEX ( `a` ) WHERE `a` = ? AND `b` > ? AND `d` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk <= 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	84
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk >= 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	85
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk >= 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	86
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk > 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	87
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` > ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` >= ? AND `pk` >= ?	Unsupported range query pattern	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2 AND pk > 3;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk > 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk >= 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk >= 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk >= 1 AND pk > 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk > 1 AND pk >= 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk < 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk <= 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk <= 2;
pk
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk < 2;
pk
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0;
a	b	c
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b in (1, 2);
a	b	c
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0 and c > 0;
a	b	c
SELECT /*+ bypass */ pk from t1 WHERE pk < 1 AND pk <= 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	101
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk <= 1 AND pk < 2;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	102
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <= ? AND `pk` < ?	Unsupported range query pattern	SQL
SELECT `pk` FROM `t1` WHERE `pk` < ? AND `pk` <= ?	Unsupported range query pattern	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0;
a	b	c
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b in (1, 2);
a	b	c
SELECT /*+ bypass */ a, b, c from t1 WHERE a > 0 and b > 0 and c > 0;
a	b	c
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	105
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk<=>1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	11
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	106
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=DATE '2019-03-25';
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	12
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	106
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=TIME '18:01:00';
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	13
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	106
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=TIMESTAMP '2019-03-25 18:01:00';
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	106
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` IN (...)	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk=ANY (SELECT pk FROM t1);
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	107
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `a` , `b` , `c` FROM `t1` WHERE `a` > ? AND `b` > ? AND `c` > ?	Non-optimal queries with filters are not allowed	SQL
SELECT /*+ bypass */ pk from t1 WHERE pk>ALL (SELECT pk FROM t1);
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	108
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `pk` FROM `t1` WHERE `pk` > ALL ( SELECT `pk` FROM `t1` )	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` <=> ?	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ DISTINCT a from t1;
a
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	109
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT DISTINCTROW `a` FROM `t1`	SELECT options not supported (such as SELECT DISTINCT)	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ALL ( SELECT `pk` FROM `t1` )	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
SELECT `pk` FROM `t1` WHERE `pk` = SOME ( SELECT `pk` FROM `t1` )	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ ALL a, b from t1;
a	b
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	110
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT DISTINCTROW `a` FROM `t1`	SELECT options not supported (such as SELECT DISTINCT)	SQL
SELECT `pk` FROM `t1` WHERE `pk` > ALL ( SELECT `pk` FROM `t1` )	Unsupported WHERE - needs to be >, >=, <, <=, =, IN	SQL
set global rocksdb_select_bypass_rejected_query_history_size=1;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
1
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ t1.pk, t2.pk from t1, t2;
pk	pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	110
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ t1.pk FROM t1 LEFT JOIN t2 using (pk)
WHERE t1.pk=1;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	110
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ pk, a from (SELECT pk, a FROM t1) AS t1_temp;
pk	a
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	110
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ pk FROM t1 WHERE pk=3 UNION DISTINCT
SELECT pk FROM t2 WHERE pk=3;
pk
SELECT /*+ bypass */ pk FROM t1 WHERE pk=3 UNION ALL
SELECT pk FROM t2 WHERE pk=3;
pk
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	110
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT ALL `a` , `b` FROM `t1`	Unsupported WHERE: should be expr [(AND expr)*] where expr only contains >, >=, <, <=, =, IN	SQL
SELECT /*+ bypass */ a, b, c FROM t1 WHERE a=1 ORDER BY a;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY b, a;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1
ORDER BY a, b, c, c, c, a, b, c, d;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY c, a;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY a, a;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1
ORDER BY a, a, a, a, a, a, a, a;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t1 FORCE INDEX(`a`) WHERE a=1 ORDER BY b, b;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t3 FORCE INDEX(`a`) WHERE a=1 ORDER BY b, b;
a	b	c
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	118
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` , `c` FROM `t3` FORCE INDEX ( `a` ) WHERE `a` = ? ORDER BY `b` , `b`	ORDER BY is not in index order	SQL
SELECT /*+ bypass */ a from t1 WHERE a=1 INTO OUTFILE 'datadir/select.out';
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	119
SELECT /*+ bypass */ a from t1 WHERE a=1 INTO DUMPFILE 'datadir/select.dump';
SHOW STATUS LIKE 'rocksdb_select_bypass%';
Variable_name	Value
rocksdb_select_bypass_executed	14
rocksdb_select_bypass_failed	0
rocksdb_select_bypass_rejected	120
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 FOR UPDATE;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 FOR UPDATE SKIP LOCKED;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 FOR UPDATE NOWAIT;
a	b	c
SELECT /*+ bypass */ a, b, c FROM t3 WHERE pk=1 LOCK IN SHARE MODE;
a	b	c
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` , `c` FROM `t3` WHERE `pk` = ? LOCK IN SHARE MODE	Only SELECT with default READ lock is supported	SQL
SELECT /*+ bypass */ HIGH_PRIORITY a, b, c FROM t3 WHERE pk=1;
a	b	c
SELECT /*+ bypass */ a FROM t3 WHERE a=1 AND a=1 AND a=1 AND a=1 AND a=1 AND
a=1 AND a=1 AND a=1 AND a=1 AND a=1 AND
a=1 AND a=1 AND a=1 AND a=1 AND a=1 AND
a=1 AND a=1;
a
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` FROM `t3` WHERE `a` = ? AND `a` = ? AND `a` = ? AND `a` = ? AND `a` = ? AND `a` = ? AND `	Too many WHERE expressions	SQL
SELECT /*+ bypass */ a FROM t4 WHERE a=1;
a
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` FROM `t4` WHERE `a` = ?	NULL fields not supported	SQL
SELECT /*+ bypass */ a,b FROM t5 FORCE INDEX (a) WHERE a='abc';
a	b
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `a` , `b` FROM `t5` FORCE INDEX ( `a` ) WHERE `a` = ?	only binary, utf8_bin, latin1_bin is supported for varchar cond field	SQL
set global rocksdb_select_bypass_rejected_query_history_size=1;
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE data = 'data100';
id1	id2	link_type	visibility	data	TIME	version
100	102	104	1	data100	105	106
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE DATA = ?	only binary, utf8_bin, latin1_bin is supported for varchar cond field	SQL
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE id1 > 100 and id1 < 300 and id1 > 110;
id1	id2	link_type	visibility	data	TIME	version
200	202	204	2	data200	205	206
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE `id1` > 	Unsupported range query pattern	SQL
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE link_type>100 and link_type > 200 and time=305;
id1	id2	link_type	visibility	data	TIME	version
300	302	304	3	data300	305	306
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE `link_ty	Unsupported range query pattern	SQL
SELECT /*+ bypass */ id1, id2, link_type, visibility, data, TIME, version
FROM t6 WHERE link_type=404 and time > 300;
id1	id2	link_type	visibility	data	TIME	version
400	402	404	4	data400	405	406
SELECT QUERY, ERROR_MSG, BYPASS_TYPE from information_schema.ROCKSDB_BYPASS_REJECTED_QUERY_HISTORY;
QUERY	ERROR_MSG	BYPASS_TYPE
SELECT `id1` , `id2` , `link_type` , `visibility` , DATA , TIME , `version` FROM `t6` WHERE `link_ty	Non-optimal queries with filters are not allowed	SQL
drop table t1;
drop table t2;
drop table t3;
drop table t4;
drop table t5;
drop table t6;
SELECT @@rocksdb_select_bypass_fail_unsupported;
@@rocksdb_select_bypass_fail_unsupported
0
set global rocksdb_select_bypass_fail_unsupported=@save_fail_unsupported;
SELECT @@rocksdb_select_bypass_fail_unsupported;
@@rocksdb_select_bypass_fail_unsupported
1
set global rocksdb_select_bypass_rejected_query_history_size=0;
SELECT @@rocksdb_select_bypass_rejected_query_history_size;
@@rocksdb_select_bypass_rejected_query_history_size
0
set global rocksdb_select_bypass_allow_filters=@save_rocksdb_select_bypass_allow_filters;
SELECT @@rocksdb_select_bypass_policy;
@@rocksdb_select_bypass_policy
opt_in
set global rocksdb_select_bypass_policy=@save_rocksdb_select_bypass_policy;
SELECT @@rocksdb_select_bypass_policy;
@@rocksdb_select_bypass_policy
always_off
